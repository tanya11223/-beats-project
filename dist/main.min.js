(()=>{const a=e=>{const t=e.find(".color__item"),o=e.find(".color__content");t.removeClass("active"),o.width(0)},i=e=>{const t=e.find(".color__content");var o=(e=>{let t=0;var o=$(window).width();const n=e.closest(".colors__list"),a=n.find(".color__title");var i=a.width()*a.length;const r=e.find(".color__container");var e=parseInt(r.css("padding-left")),l=parseInt(r.css("padding-right")),s=window.matchMedia("(max-width: 768px)").matches,d=window.matchMedia("(max-width: 480px)").matches;return s&&(t=o-i),d&&(t=o-a.width()),{container:t=s||d?t:500,textContainer:t-l-e}})(e);e.addClass("active"),t.width(o.container)};$(".color__title").on("click",e=>{e.preventDefault();const t=$(e.currentTarget),o=t.closest(".color__item");var e=o.hasClass("active"),n=t.closest(".colors__list");e?a(n):(a(n),i(o))})})();const validateFields=(e,t)=>{return t.forEach(e=>{e.removeClass(".input-error"),""==e.val().trim()&&e.addClass("input-error")}),0==e.find(".input-error").length};$(".form").submit(e=>{e.preventDefault();const t=$(e.currentTarget),o=t.find("[name='name']"),n=t.find("[name='phone']"),a=t.find("[name='comment']"),i=t.find("[name= 'to']"),r=$("#modal"),l=r.find(".modal__content");if(r.removeClass("error-modal"),validateFields(t,[o,n,a,i])){const s=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:o.val(),phone:n.val(),comment:a.val(),to:i.val()}});s.done(e=>{l.text(e.message)}),s.fail(e=>{e=e.responseJSON.message;l.text(e),r.addClass("error-modal")}),s.always(()=>{$.fancybox.open({src:"#modal",type:"inline"})})}}),$(".app-close-btn").click(e=>{e.preventDefault(),$.fancybox.close()});let myMap;const init=()=>{myMap=new ymaps.Map("map",{center:[55.76,37.64],zoom:11,controls:[]});const t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/marker.svg",iconImageSize:[46,57],iconImageOffset:[-35,-52]});[[55.757349,37.622441],[55.759132,37.580903],[55.740644,37.580732],[55.742605,37.599911]].forEach(e=>{t.add(new ymaps.Placemark(e))}),myMap.geoObjects.add(t),myMap.behaviors.disable("scrollZoom")},openMenu=(ymaps.ready(init),document.querySelector("#openOverlay")),body=document.body,create=createModal();function createModal(){const t=document.createElement("div");t.classList.add("overlay");var e=document.querySelector("#overlayTemplate");t.innerHTML=e.innerHTML;const o=t.querySelector("#close");return o.addEventListener("click",e=>{e.preventDefault(),body.removeChild(t)}),t.addEventListener("click",e=>{e.preventDefault(),e.target.classList.contains("menu__link")&&body.removeChild(t)}),t}openMenu.addEventListener("click",e=>{e.preventDefault(),body.appendChild(create)});const sections=$("section"),display=$(".maincontent"),sidemenu=$(".fixed-menu"),menuItems=sidemenu.find(".fixed-menu__item"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile();let inscroll=!1;sections.first().addClass("active");const countSectionPosition=e=>{e*=-100;return isNaN(e)?(console.error("передано неверное значение в countSectionPosition"),0):e},resetActiveClassForItem=(e,t,o)=>{e.eq(t).addClass(o).siblings().removeClass(o)},performTransition=e=>{var t;inscroll||(inscroll=!0,t=countSectionPosition(e),display.css({transform:`translateY(${t}%)`}),resetActiveClassForItem(sections,e,"active"),setTimeout(()=>{inscroll=!1,resetActiveClassForItem(menuItems,e,"fixed-menu__item--active")},1300))},viewportScroller=()=>{const e=sections.filter(".active"),t=e.next(),o=e.prev();return{next(){t.length&&performTransition(t.index())},prev(){o.length&&performTransition(o.index())}}},playBtn=($(window).on("wheel",e=>{e=e.originalEvent.deltaY;const t=viewportScroller();0<e&&t.next(),e<0&&t.prev()}),$(window).on("keydown",e=>{var t=e.target.tagName.toLowerCase(),t="input"==t||"textarea"==t;const o=viewportScroller();if(!t)switch(e.keyCode){case 38:o.prev();break;case 40:o.next()}}),$(".wrapper").on("touchmove",e=>e.preventDefault()),$(document).on("click","[data-scroll-to]",e=>{e.preventDefault();const t=$(e.currentTarget);e=t.attr("data-scroll-to");const o=$(`[data-section-id=${e}]`);performTransition(o.index())}),isMobile&&$("body").swipe({swipe:function(e,t){const o=viewportScroller();let n="down"==t?"prev":"up"==t?"next":"";n&&o[n]()}}),document.querySelector(".video__player-img")),video=document.getElementById("player"),playerPlayBrn=document.querySelector(".duration__img"),durationControl=document.getElementById("durationLevel"),soundControl=document.getElementById("micLevel"),soundBtn=document.getElementById("soundBtn"),dynamicBtn=document.getElementById("dynamic");let intervalId,soundLevel;function playStop(){playerPlayBrn.classList.toggle("video__player-img--active"),playBtn.classList.toggle("active"),video.paused?(video.play(),intervalId=setInterval(updateDuration,1e3/60)):(clearInterval(intervalId),video.pause())}function setVideoDuration(){video.currentTime=durationControl.value,updateDuration()}function updateDuration(){durationControl.value=video.currentTime;var e=video.duration/100,e=video.currentTime/e;durationControl.style.background=`linear-gradient(90deg, #E01F3D 0%, #E01F3D ${e}%, #333 ${e}%)`}function changeSoundVolume(){video.volume=soundControl.value/10,0==video.volume?soundBtn.classList.add("active"):soundBtn.classList.remove("active")}function soundOf(){0===video.volume?(video.volume=soundLevel,soundControl.value=10*soundLevel,soundBtn.classList.remove("active")):(soundLevel=video.volume,video.volume=0,soundControl.value=0,soundBtn.classList.add("active"))}video.addEventListener("loadeddata",function(){video.addEventListener("click",playStop);let t=document.querySelectorAll(".play");for(let e=0;e<t.length;e++)t[i].addEventListener("click",playStop);durationControl.min=0,durationControl.value=0,durationControl.max=video.duration,durationControl.addEventListener("input",setVideoDuration),soundControl.min=0,soundControl.max=10,soundControl.value=soundControl.max,soundControl.addEventListener("input",changeSoundVolume),dynamicBtn.addEventListener("click",soundOf),video.addEventListener("ended",()=>{playBtn.classList.toggle("video__player-img--active"),playerPlayBrn.classList.remove("active"),video.currentTime=0})});const slider=$(".products__list").bxSlider({pager:!1,controls:!1}),findBlockByAlias=($(".product-slider__arrow--prev").click(e=>{e.preventDefault(),slider.goToPrevSlide()}),$(".product-slider__arrow--next").click(e=>{e.preventDefault(),slider.goToNextSlide()}),o=>$(".reviews__item").filter((e,t)=>$(t).attr("data-linked-with")==o)),openItem=($(".review-switcher__link").click(e=>{e.preventDefault();const t=$(e.currentTarget);e=t.attr("data-open");const o=findBlockByAlias(e),n=t.closest(".interactive-avatar");o.addClass("active").siblings().removeClass("active"),n.addClass("active").siblings().removeClass("active")}),e=>{const t=e.closest(".team__item"),o=t.find(".team__content"),n=o.find(".team__content-block");e=n.height();t.addClass("active"),o.height(e)}),closeEveryItem=e=>{const t=e.find(".team__content"),o=e.find(".team__item");o.removeClass("active"),t.height(0)};$(".team__title").click(e=>{const t=$(e.currentTarget);e=t.closest(".team");const o=t.closest(".team__item");o.hasClass("active")?closeEveryItem(e):(closeEveryItem(e),openItem(t))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbG9ycy1tZW51LWFjY28uanMiLCJmb3JtLW1vZGFsLmpzIiwibWFwLmpzIiwibWVudS5qcyIsIm9wcy5qcyIsInBsYXllci5qcyIsInNsaWRlci5qcyIsInRhYnMuanMiLCJ0ZWFtLmpzIl0sIm5hbWVzIjpbImNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIiLCJjb250YWluZXIiLCJpdGVtcyIsImZpbmQiLCJjb250ZW50IiwicmVtb3ZlQ2xhc3MiLCJ3aWR0aCIsIm9wZW5JdGVtIiwiaXRlbSIsImhpZGRlbkNvbnRlbnQiLCJyZXFXaWR0aCIsImxldCIsInJlcUl0ZW1XaWR0aCIsInNjcmVlbldpZHRoIiwiJCIsIndpbmRvdyIsImNsb3Nlc3QiLCJ0aXRsZXNCbG9ja3MiLCJ0aXRsZXNXaWR0aCIsImxlbmd0aCIsInRleHRDb250YWluZXIiLCJwYWRkaW5nTGVmdCIsInBhcnNlSW50IiwiY3NzIiwicGFkZGluZ1JpZ2h0IiwiaXNUYWJsZXQiLCJtYXRjaE1lZGlhIiwibWF0Y2hlcyIsImlzTW9iaWxlIiwibWVzdXJlV2lkdGgiLCJhZGRDbGFzcyIsIm9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwiJHRoaXMiLCJjdXJyZW50VGFyZ2V0IiwiaXRlbU9wZW5lZCIsImhhc0NsYXNzIiwidmFsaWRhdGVGaWVsZHMiLCJmb3JtIiwiZmllbGRzQXJyYXkiLCJmb3JFYWNoIiwiZmllbGQiLCJ2YWwiLCJ0cmltIiwic3VibWl0IiwibmFtZSIsInBob25lIiwiY29tbWVudCIsInRvIiwibW9kYWwiLCJyZXF1ZXN0IiwiYWpheCIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJkb25lIiwidGV4dCIsIm1lc3NhZ2UiLCJmYWlsIiwicmVzcG9uc2VKU09OIiwiYWx3YXlzIiwiZmFuY3lib3giLCJvcGVuIiwic3JjIiwidHlwZSIsImNsaWNrIiwiY2xvc2UiLCJteU1hcCIsImluaXQiLCJ5bWFwcyIsIk1hcCIsImNlbnRlciIsInpvb20iLCJjb250cm9scyIsIm15Q29sbGVjdGlvbiIsIkdlb09iamVjdENvbGxlY3Rpb24iLCJkcmFnZ2FibGUiLCJpY29uTGF5b3V0IiwiaWNvbkltYWdlSHJlZiIsImljb25JbWFnZVNpemUiLCJpY29uSW1hZ2VPZmZzZXQiLCJjb29yZCIsImFkZCIsIlBsYWNlbWFyayIsImdlb09iamVjdHMiLCJiZWhhdmlvcnMiLCJkaXNhYmxlIiwib3Blbk1lbnUiLCJyZWFkeSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImJvZHkiLCJjcmVhdGUiLCJjcmVhdGVNb2RhbCIsIm92ZXJsYXlFbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsInRlbXBsYXRlIiwiaW5uZXJIVE1MIiwiY2xvc2VFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUNoaWxkIiwidGFyZ2V0IiwiY29udGFpbnMiLCJhcHBlbmRDaGlsZCIsInNlY3Rpb25zIiwiZGlzcGxheSIsInNpZGVtZW51IiwibWVudUl0ZW1zIiwibW9iaWxlRGV0ZWN0IiwiTW9iaWxlRGV0ZWN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwibW9iaWxlIiwiaW5zY3JvbGwiLCJmaXJzdCIsImNvdW50U2VjdGlvblBvc2l0aW9uIiwicG9zaXRpb24iLCJpc05hTiIsImNvbnNvbGUiLCJlcnJvciIsInJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtIiwiaXRlbUVxIiwiYWN0aXZlQ2xhc3MiLCJlcSIsInNpYmxpbmdzIiwicGVyZm9ybVRyYW5zaXRpb24iLCJzZWN0aW9uRXEiLCJ0cmFuc2Zvcm0iLCJzZXRUaW1lb3V0IiwidHJhbnNpdGlvbk92ZXIiLCJ2aWV3cG9ydFNjcm9sbGVyIiwiYWN0aXZlU2VjdGlvbiIsImZpbHRlciIsIm5leHRTZWN0aW9uIiwibmV4dCIsInByZXZTZWN0aW9uIiwicHJldiIsImluZGV4IiwicGxheUJ0biIsImRlbHRhWSIsIm9yaWdpbmFsRXZlbnQiLCJzY3JvbGxlciIsInRhZ05hbWUiLCJ0b0xvd2VyQ2FzZSIsInVzZXJUeXBpbmdJbklucHV0cyIsImtleUNvZGUiLCJhdHRyIiwicmVxU2VjdGlvbiIsInN3aXBlIiwiZXZlbnQiLCJkaXJlY3Rpb24iLCJzY3JvbGxEaXJlY3Rpb24iLCJ2aWRlbyIsImdldEVsZW1lbnRCeUlkIiwicGxheWVyUGxheUJybiIsImR1cmF0aW9uQ29udHJvbCIsInNvdW5kQ29udHJvbCIsInNvdW5kQnRuIiwiZHluYW1pY0J0biIsImludGVydmFsSWQiLCJzb3VuZExldmVsIiwicGxheVN0b3AiLCJ0b2dnbGUiLCJwYXVzZWQiLCJwbGF5Iiwic2V0SW50ZXJ2YWwiLCJ1cGRhdGVEdXJhdGlvbiIsImNsZWFySW50ZXJ2YWwiLCJwYXVzZSIsInNldFZpZGVvRHVyYXRpb24iLCJjdXJyZW50VGltZSIsInZhbHVlIiwic3RlcCIsImR1cmF0aW9uIiwicGVyY2VudCIsInN0eWxlIiwiYmFja2dyb3VuZCIsImNoYW5nZVNvdW5kVm9sdW1lIiwidm9sdW1lIiwicmVtb3ZlIiwic291bmRPZiIsInBsYXlCdXR0b25zIiwicXVlcnlTZWxlY3RvckFsbCIsImkiLCJtaW4iLCJtYXgiLCJzbGlkZXIiLCJieFNsaWRlciIsInBhZ2VyIiwiZmluZEJsb2NrQnlBbGlhcyIsImdvVG9QcmV2U2xpZGUiLCJnb1RvTmV4dFNsaWRlIiwiYWxpYXMiLCJuZHgiLCJpdGVtdG9TaG93IiwiY3VySXRlbSIsImNvbnRlbnRCbG9jayIsInRleHRCbG9jayIsInJlcUhlaWdodCIsImhlaWdodCIsImNsb3NlRXZlcnlJdGVtIiwiaXRlbUNvbnRhaW5lciIsImVsZW1Db250YWluZXIiXSwibWFwcGluZ3MiOiJDQUFBLEtBRUEsTUErQkFBLEVBQUFDLElBQ0EsTUFBQUMsRUFBQUQsRUFBQUUsS0FBQSxnQkFDQUMsRUFBQUgsRUFBQUUsS0FBQSxtQkFFQUQsRUFBQUcsWUFBQSxVQUNBRCxFQUFBRSxNQUFBLElBR0FDLEVBQUFDLElBQ0EsTUFBQUMsRUFBQUQsRUFBQUwsS0FBQSxtQkFDQSxJQUFBTyxHQXpDQUYsSUFDQUcsSUFBQUMsRUFBQSxFQUNBLElBQUFD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VUFBQWdHLFdBQUF6SCxZQUFBLFlDZkFHLElBQ0EsTUFBQVAsRUFBQU8sRUFBQVEsUUFBQSxlQUNBc0wsRUFBQXJNLEVBQUFFLEtBQUEsa0JBQ0FvTSxFQUFBRCxFQUFBbk0sS0FBQSx3QkFDQXFNLEVBQUFELEVBQUFFLFNBR0F4TSxFQUFBNkIsU0FBQSxVQUNBd0ssRUFBQUcsT0FBQUQsS0FHQUUsZUFBQXpNLElBQ0EsTUFBQUMsRUFBQUQsRUFBQUUsS0FBQSxrQkFDQXdNLEVBQUExTSxFQUFBRSxLQUFBLGVBRUF3TSxFQUFBdE0sWUFBQSxVQUNBSCxFQUFBdU0sT0FBQSxJQUdBM0wsRUFBQSxnQkFBQW9ELE1BQUFsQyxJQUNBLE1BQUFFLEVBQUFwQixFQUFBa0IsRUFBQUcsZUFDQWxDLEVBQUFpQyxFQUFBbEIsUUFBQSxTQUNBLE1BQUE0TCxFQUFBMUssRUFBQWxCLFFBQUEsZUFFQTRMLEVBQUF2SyxTQUFBLFVBQ0FxSyxlQUFBek0sSUFFQXlNLGVBQUF6TSxHQUNBTSxTQUFBMkIiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoKCk9PntcblxuY29uc3QgbWVzdXJlV2lkdGggPSBpdGVtID0+IHtcbiAgbGV0IHJlcUl0ZW1XaWR0aCA9IDA7XG4gIGNvbnN0IHNjcmVlbldpZHRoID0gJCh3aW5kb3cpLndpZHRoKCk7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGl0ZW0uY2xvc2VzdChcIi5jb2xvcnNfX2xpc3RcIik7XG4gIGNvbnN0IHRpdGxlc0Jsb2NrcyA9IGNvbnRhaW5lci5maW5kKFwiLmNvbG9yX190aXRsZVwiKTtcbiAgY29uc3QgdGl0bGVzV2lkdGggPSB0aXRsZXNCbG9ja3Mud2lkdGgoKSAqIHRpdGxlc0Jsb2Nrcy5sZW5ndGg7XG5cbiAgY29uc3QgdGV4dENvbnRhaW5lciA9IGl0ZW0uZmluZChcIi5jb2xvcl9fY29udGFpbmVyXCIpO1xuICBjb25zdCBwYWRkaW5nTGVmdCA9IHBhcnNlSW50KHRleHRDb250YWluZXIuY3NzKFwicGFkZGluZy1sZWZ0XCIpKTtcbiAgY29uc3QgcGFkZGluZ1JpZ2h0ID0gcGFyc2VJbnQodGV4dENvbnRhaW5lci5jc3MoXCJwYWRkaW5nLXJpZ2h0XCIpKTtcblxuXG4gIGNvbnN0IGlzVGFibGV0ID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWF4LXdpZHRoOiA3NjhweClcIikubWF0Y2hlcztcbiAgY29uc3QgaXNNb2JpbGUgPSB3aW5kb3cubWF0Y2hNZWRpYShcIihtYXgtd2lkdGg6IDQ4MHB4KVwiKS5tYXRjaGVzO1xuXG4gIGlmKGlzVGFibGV0KSB7XG4gICAgcmVxSXRlbVdpZHRoID0gc2NyZWVuV2lkdGggLSB0aXRsZXNXaWR0aDtcbiAgfSBcbiAgaWYoaXNNb2JpbGUpIHtcbiAgICByZXFJdGVtV2lkdGggPSBzY3JlZW5XaWR0aCAtIHRpdGxlc0Jsb2Nrcy53aWR0aCgpO1xuICB9IFxuICBpZighaXNUYWJsZXQgJiYgIWlzTW9iaWxlKXtcbiAgICByZXFJdGVtV2lkdGggPSA1MDA7XG4gIH1cblxuICByZXR1cm57XG4gICAgY29udGFpbmVyOiByZXFJdGVtV2lkdGgsXG4gICAgdGV4dENvbnRhaW5lcjogcmVxSXRlbVdpZHRoIC0gcGFkZGluZ1JpZ2h0IC0gcGFkZGluZ0xlZnRcbiAgfVxufTtcblxuY29uc3QgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lciA9IGNvbnRhaW5lciA9PiB7XG4gIGNvbnN0IGl0ZW1zID0gY29udGFpbmVyLmZpbmQoXCIuY29sb3JfX2l0ZW1cIik7XG4gIGNvbnN0IGNvbnRlbnQgPSBjb250YWluZXIuZmluZChcIi5jb2xvcl9fY29udGVudFwiKTtcblxuICBpdGVtcy5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgY29udGVudC53aWR0aCgwKTtcbn07XG5cbmNvbnN0IG9wZW5JdGVtID0gaXRlbSA9PiB7XG4gIGNvbnN0IGhpZGRlbkNvbnRlbnQgPSBpdGVtLmZpbmQoXCIuY29sb3JfX2NvbnRlbnRcIik7XG4gIGNvbnN0IHJlcVdpZHRoID0gbWVzdXJlV2lkdGgoaXRlbSk7XG5cbiAgaXRlbS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcbiAgaGlkZGVuQ29udGVudC53aWR0aChyZXFXaWR0aC5jb250YWluZXIpO1xufVxuXG4kKFwiLmNvbG9yX190aXRsZVwiKS5vbihcImNsaWNrXCIsIChlKSA9PntcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBcbiAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XG4gIGNvbnN0IGl0ZW0gPSAkdGhpcy5jbG9zZXN0KFwiLmNvbG9yX19pdGVtXCIpO1xuICBjb25zdCBpdGVtT3BlbmVkID0gaXRlbS5oYXNDbGFzcyhcImFjdGl2ZVwiKTtcbiAgY29uc3QgY29udGFpbmVyID0gJHRoaXMuY2xvc2VzdChcIi5jb2xvcnNfX2xpc3RcIik7XG5cbiAgaWYgKGl0ZW1PcGVuZWQpIHtcbiAgICBjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyKGNvbnRhaW5lcilcbiAgfSBlbHNlIHtcbiAgICBjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyKGNvbnRhaW5lcilcbiAgICBvcGVuSXRlbShpdGVtKTtcbiAgfVxufSk7XG59KSgpOyIsImNvbnN0IHZhbGlkYXRlRmllbGRzID0gKGZvcm0sIGZpZWxkc0FycmF5KSA9PiB7XG4gIGZpZWxkc0FycmF5LmZvckVhY2goZmllbGQgPT4ge1xuICAgIGZpZWxkLnJlbW92ZUNsYXNzKFwiLmlucHV0LWVycm9yXCIpO1xuICAgIGlmIChmaWVsZC52YWwoKS50cmltKCkgPT0gXCJcIikge1xuICAgICAgZmllbGQuYWRkQ2xhc3MoXCJpbnB1dC1lcnJvclwiKTtcbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IGVycm9yRmllbGRzID0gZm9ybS5maW5kKFwiLmlucHV0LWVycm9yXCIpO1xuXG4gIHJldHVybiBlcnJvckZpZWxkcy5sZW5ndGggPT0gMDtcbn1cblxuJChcIi5mb3JtXCIpLnN1Ym1pdChlID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IGZvcm0gPSAkKGUuY3VycmVudFRhcmdldCk7XG4gIGNvbnN0IG5hbWUgPSBmb3JtLmZpbmQoXCJbbmFtZT0nbmFtZSddXCIpO1xuICBjb25zdCBwaG9uZSA9IGZvcm0uZmluZChcIltuYW1lPSdwaG9uZSddXCIpO1xuICBjb25zdCBjb21tZW50ID0gZm9ybS5maW5kKFwiW25hbWU9J2NvbW1lbnQnXVwiKTtcbiAgY29uc3QgdG8gPSBmb3JtLmZpbmQoXCJbbmFtZT0gJ3RvJ11cIik7XG5cbiAgY29uc3QgbW9kYWwgPSAkKFwiI21vZGFsXCIpO1xuICBjb25zdCBjb250ZW50ID0gbW9kYWwuZmluZChcIi5tb2RhbF9fY29udGVudFwiKTtcbiAgXG4gIG1vZGFsLnJlbW92ZUNsYXNzKFwiZXJyb3ItbW9kYWxcIik7XG5cbiAgY29uc3QgaXNWYWxpZCA9IHZhbGlkYXRlRmllbGRzKGZvcm0sIFtuYW1lLCBwaG9uZSwgY29tbWVudCwgdG9dKTtcbiAgXG4gIFxuICBcblxuICBpZiAoaXNWYWxpZCkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSAkLmFqYXgoe1xuICAgICAgdXJsOiBcImh0dHBzOi8vd2ViZGV2LWFwaS5sb2Z0c2Nob29sLmNvbS9zZW5kbWFpbFwiLFxuICAgICAgbWV0aG9kOiBcInBvc3RcIixcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgbmFtZTogbmFtZS52YWwoKSxcbiAgICAgICAgcGhvbmU6IHBob25lLnZhbCgpLFxuICAgICAgICBjb21tZW50OiBjb21tZW50LnZhbCgpLFxuICAgICAgICB0bzogdG8udmFsKCksXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgcmVxdWVzdC5kb25lKGRhdGEgPT57XG4gICAgICBjb250ZW50LnRleHQoZGF0YS5tZXNzYWdlKTtcbiAgICB9KTtcblxuICAgIHJlcXVlc3QuZmFpbChkYXRhID0+e1xuICAgICAgY29uc3QgbWVzc2FnZSA9IGRhdGEucmVzcG9uc2VKU09OLm1lc3NhZ2U7XG4gICAgICBjb250ZW50LnRleHQobWVzc2FnZSk7XG4gICAgICBtb2RhbC5hZGRDbGFzcyhcImVycm9yLW1vZGFsXCIpO1xuICAgIH0pO1xuXG4gICAgcmVxdWVzdC5hbHdheXMoKCkgPT4ge1xuICAgICAgJC5mYW5jeWJveC5vcGVuKHtcbiAgICAgICAgc3JjOiBcIiNtb2RhbFwiLFxuICAgICAgICB0eXBlOiBcImlubGluZVwiXG4gICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn0pO1xuXG4kKFwiLmFwcC1jbG9zZS1idG5cIikuY2xpY2soZSA9PntcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICQuZmFuY3lib3guY2xvc2UoKTtcbn0pOyIsImxldCBteU1hcDtcblxuY29uc3QgaW5pdCA9ICgpID0+IHtcbiAgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwXCIsIHtcbiAgICBjZW50ZXI6IFs1NS43NiwgMzcuNjRdLFxuICAgIHpvb206IDExLFxuICAgIGNvbnRyb2xzOiBbXSxcbiAgfSk7XG5cbiAgY29uc3QgY29vcmRzID0gW1xuICAgIFs1NS43NTczNDksIDM3LjYyMjQ0MV0sXG4gICAgWzU1Ljc1OTEzMiwgMzcuNTgwOTAzXSxcbiAgICBbNTUuNzQwNjQ0LCAzNy41ODA3MzJdLFxuICAgIFs1NS43NDI2MDUsIDM3LjU5OTkxMV0sXG4gIF07XG5cbiAgY29uc3QgbXlDb2xsZWN0aW9uID0gbmV3IHltYXBzLkdlb09iamVjdENvbGxlY3Rpb24oe30se1xuICAgICBkcmFnZ2FibGU6IGZhbHNlLFxuICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXG4gICAgIGljb25JbWFnZUhyZWY6IFwiLi9pbWcvbWFya2VyLnN2Z1wiLFxuICAgICBpY29uSW1hZ2VTaXplOiBbNDYsIDU3XSxcbiAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTM1LCAtNTJdXG4gIH0pO1xuXG4gIGNvb3Jkcy5mb3JFYWNoKGNvb3JkID0+IHtcbiAgICBteUNvbGxlY3Rpb24uYWRkKG5ldyB5bWFwcy5QbGFjZW1hcmsoY29vcmQpKTtcbiAgfSk7XG5cbiAgbXlNYXAuZ2VvT2JqZWN0cy5hZGQobXlDb2xsZWN0aW9uKTtcblxuICBteU1hcC5iZWhhdmlvcnMuZGlzYWJsZSgnc2Nyb2xsWm9vbScpO1xufVxuXG55bWFwcy5yZWFkeShpbml0KTsiLCJjb25zdCBvcGVuTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjb3Blbk92ZXJsYXlcIik7XG5jb25zdCBib2R5ID0gZG9jdW1lbnQuYm9keTtcbmNvbnN0IGNyZWF0ZSA9IGNyZWF0ZU1vZGFsKCk7XG5cbm9wZW5NZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBlID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBib2R5LmFwcGVuZENoaWxkKGNyZWF0ZSk7XG59KVxuXG5mdW5jdGlvbiBjcmVhdGVNb2RhbCAoKSB7XG4gIGNvbnN0IG92ZXJsYXlFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm92ZXJsYXlcIik7IFxuXG4gIGNvbnN0IHRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNvdmVybGF5VGVtcGxhdGVcIik7XG5cbiAgb3ZlcmxheUVsZW1lbnQuaW5uZXJIVE1MID0gdGVtcGxhdGUuaW5uZXJIVE1MOyBcblxuICBjb25zdCBjbG9zZUVsZW1lbnQgPSBvdmVybGF5RWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2Nsb3NlXCIpO1xuXG4gIGNsb3NlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheUVsZW1lbnQpO1xuICB9KTtcblxuICBvdmVybGF5RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtZW51X19saW5rJykpIHtcbiAgICAgIGJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheUVsZW1lbnQpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIG92ZXJsYXlFbGVtZW50O1xufSIsImNvbnN0IHNlY3Rpb25zID0gJChcInNlY3Rpb25cIik7XG5jb25zdCBkaXNwbGF5ID0gJChcIi5tYWluY29udGVudFwiKTtcbmNvbnN0IHNpZGVtZW51ID0gJChcIi5maXhlZC1tZW51XCIpO1xuY29uc3QgbWVudUl0ZW1zID0gc2lkZW1lbnUuZmluZChcIi5maXhlZC1tZW51X19pdGVtXCIpO1xuXG5jb25zdCBtb2JpbGVEZXRlY3QgPSBuZXcgTW9iaWxlRGV0ZWN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtcbmNvbnN0IGlzTW9iaWxlID0gbW9iaWxlRGV0ZWN0Lm1vYmlsZSgpO1xuXG5sZXQgaW5zY3JvbGwgPSBmYWxzZTtcblxuc2VjdGlvbnMuZmlyc3QoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcblxuY29uc3QgY291bnRTZWN0aW9uUG9zaXRpb24gPSAoc2VjdGlvbkVxKSA9PiB7XG4gIGNvbnN0IHBvc2l0aW9uID0gc2VjdGlvbkVxICogLTEwMDtcblxuICBpZiAoaXNOYU4ocG9zaXRpb24pKSB7XG4gICAgY29uc29sZS5lcnJvcihcItC/0LXRgNC10LTQsNC90L4g0L3QtdCy0LXRgNC90L7QtSDQt9C90LDRh9C10L3QuNC1INCyIGNvdW50U2VjdGlvblBvc2l0aW9uXCIpO1xuICAgIHJldHVybiAwO1xuICB9XG4gIHJldHVybiBwb3NpdGlvbjtcbn1cblxuY29uc3QgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0gPSAoaXRlbXMsIGl0ZW1FcSwgYWN0aXZlQ2xhc3MpID0+IHtcbiAgaXRlbXMuZXEoaXRlbUVxKS5hZGRDbGFzcyhhY3RpdmVDbGFzcykuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhhY3RpdmVDbGFzcyk7XG59XG5cbmNvbnN0IHBlcmZvcm1UcmFuc2l0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xuXG4gIGlmKGluc2Nyb2xsKSByZXR1cm47XG5cbiAgICBjb25zdCB0cmFuc2l0aW9uT3ZlciA9IDEwMDA7XG4gICAgY29uc3QgbW91c2VJbmVydGlhT3ZlciA9IDMwMDtcblxuICAgIGluc2Nyb2xsID0gdHJ1ZTtcbiAgICBjb25zdCBwb3NpdGlvbiA9IGNvdW50U2VjdGlvblBvc2l0aW9uKHNlY3Rpb25FcSk7XG5cbiAgZGlzcGxheS5jc3Moe1xuICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoJHtwb3NpdGlvbn0lKWBcbiAgfSk7XG4gIFxuICByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbShzZWN0aW9ucywgc2VjdGlvbkVxLCBcImFjdGl2ZVwiKTtcblxuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgaW5zY3JvbGwgPSBmYWxzZTtcblxuICAgICByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbShtZW51SXRlbXMsIHNlY3Rpb25FcSwgXCJmaXhlZC1tZW51X19pdGVtLS1hY3RpdmVcIik7XG5cblxuICB9LCB0cmFuc2l0aW9uT3ZlciArIG1vdXNlSW5lcnRpYU92ZXIpO1xuICB9XG5cbmNvbnN0IHZpZXdwb3J0U2Nyb2xsZXIgPSAoKSA9PiB7XG4gIGNvbnN0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9ucy5maWx0ZXIoXCIuYWN0aXZlXCIpO1xuICBjb25zdCBuZXh0U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ubmV4dCgpO1xuICBjb25zdCBwcmV2U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ucHJldigpO1xuICBcbiAgcmV0dXJue1xuICAgIG5leHQoKSB7XG4gICAgICBpZihuZXh0U2VjdGlvbi5sZW5ndGgpIHtcbiAgICAgICAgcGVyZm9ybVRyYW5zaXRpb24obmV4dFNlY3Rpb24uaW5kZXgoKSlcbiAgICAgIH1cbiAgICB9LFxuICAgIHByZXYoKSB7ICBcbiAgICBpZihwcmV2U2VjdGlvbi5sZW5ndGgpIHtcbiAgICBwZXJmb3JtVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKVxuICB9XG4gIH0sXG4gIH07XG59O1xuXG4kKHdpbmRvdykub24oXCJ3aGVlbFwiLCBlID0+IHtcbiAgY29uc3QgZGVsdGFZID0gZS5vcmlnaW5hbEV2ZW50LmRlbHRhWTtcbiAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XG4gIFxuICBpZiAoZGVsdGFZID4gMCkgIHtcbiAgICBzY3JvbGxlci5uZXh0KCk7XG4gIH1cblxuICBpZiAoZGVsdGFZIDwgMCkge1xuICAgIHNjcm9sbGVyLnByZXYoKTtcbiAgfVxufSk7XG5cbiQod2luZG93KS5vbihcImtleWRvd25cIiwgZSA9PiB7XG4gIGNvbnN0IHRhZ05hbWUgPSBlLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IHVzZXJUeXBpbmdJbklucHV0cyA9IHRhZ05hbWUgPT0gXCJpbnB1dFwiIHx8IHRhZ05hbWUgPT0gXCJ0ZXh0YXJlYVwiO1xuICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcblxuICBpZiAodXNlclR5cGluZ0luSW5wdXRzKSByZXR1cm47XG4gICAgc3dpdGNoIChlLmtleUNvZGUpIHtcbiAgICAgIGNhc2UgMzg6IC8vcHJldlxuICAgICAgIHNjcm9sbGVyLnByZXYoKTtcbiAgICAgICBicmVhaztcbiAgXG4gICAgICBjYXNlIDQwOiAvL25leHRcbiAgICAgICBzY3JvbGxlci5uZXh0KCk7XG4gICAgICAgYnJlYWs7XG4gICAgfVxuICBcbn0pO1xuXG4kKFwiLndyYXBwZXJcIikub24oXCJ0b3VjaG1vdmVcIixlID0+IGUucHJldmVudERlZmF1bHQoKSk7XG5cbiQoZG9jdW1lbnQpLm9uKFwiY2xpY2tcIiwgXCJbZGF0YS1zY3JvbGwtdG9dXCIsIGUgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XG4gIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLXNjcm9sbC10b1wiKTtcbiAgY29uc3QgcmVxU2VjdGlvbiA9ICQoYFtkYXRhLXNlY3Rpb24taWQ9JHt0YXJnZXR9XWApO1xuXG4gIHBlcmZvcm1UcmFuc2l0aW9uKHJlcVNlY3Rpb24uaW5kZXgoKSk7XG59KTtcblxuLy90b3VjaCBzd2lwZSBcbmlmIChpc01vYmlsZSkge1xuICAvL2h0dHBzOi8vZ2l0aHViLmNvbS9tYXR0YnJ5c29uL1RvdWNoU3dpcGUtSnF1ZXJ5LVBsdWdpblxuJChcImJvZHlcIikuc3dpcGUoIHtcbiAgc3dpcGU6ZnVuY3Rpb24oXG4gICAgZXZlbnQsIFxuICAgIGRpcmVjdGlvbixcbiAgICAgKSB7XG4gICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XG4gICAgbGV0IHNjcm9sbERpcmVjdGlvbiA9IFwiXCI7XG5cbiAgICBpZiAoZGlyZWN0aW9uID09IFwidXBcIikgc2Nyb2xsRGlyZWN0aW9uID0gXCJuZXh0XCI7XG4gICAgaWYgKGRpcmVjdGlvbiA9PSBcImRvd25cIikgc2Nyb2xsRGlyZWN0aW9uID0gXCJwcmV2XCI7XG4gICAgaWYgKCFzY3JvbGxEaXJlY3Rpb24pIHJldHVybjtcbiAgICBcbiAgICBzY3JvbGxlcltzY3JvbGxEaXJlY3Rpb25dKCk7XG4gIH0sXG59KTtcbn1cbiIsImNvbnN0IHBsYXlCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnZpZGVvX19wbGF5ZXItaW1nXCIpO1xuY29uc3QgdmlkZW8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheWVyJyk7XG5jb25zdCBwbGF5ZXJQbGF5QnJuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kdXJhdGlvbl9faW1nXCIpO1xuY29uc3QgZHVyYXRpb25Db250cm9sID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2R1cmF0aW9uTGV2ZWwnKTtcbmNvbnN0IHNvdW5kQ29udHJvbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaWNMZXZlbCcpO1xuY29uc3Qgc291bmRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc291bmRCdG4nKTtcbmNvbnN0IGR5bmFtaWNCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHluYW1pYycpO1xuXG5sZXQgaW50ZXJ2YWxJZDtcbmxldCBzb3VuZExldmVsO1xuXG52aWRlby5hZGRFdmVudExpc3RlbmVyKFwibG9hZGVkZGF0YVwiLCBmdW5jdGlvbigpIHtcbiAgdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwbGF5U3RvcCk7XG5cbiAgbGV0IHBsYXlCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYXknKTtcblxuICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcGxheUJ1dHRvbnMubGVuZ3RoOyBpbmRleCsrKSB7XG4gIHBsYXlCdXR0b25zW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcGxheVN0b3ApO1xufVxuXG5kdXJhdGlvbkNvbnRyb2wubWluID0gMDtcbmR1cmF0aW9uQ29udHJvbC52YWx1ZSA9IDA7XG5kdXJhdGlvbkNvbnRyb2wubWF4ID0gdmlkZW8uZHVyYXRpb247XG5kdXJhdGlvbkNvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBzZXRWaWRlb0R1cmF0aW9uKTtcblxuc291bmRDb250cm9sLm1pbiA9IDA7XG5zb3VuZENvbnRyb2wubWF4ID0gMTA7XG5zb3VuZENvbnRyb2wudmFsdWUgPSBzb3VuZENvbnRyb2wubWF4O1xuc291bmRDb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgY2hhbmdlU291bmRWb2x1bWUpO1xuXG5keW5hbWljQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc291bmRPZik7XG5cbnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2VuZGVkJywgKCkgPT4ge1xuICBwbGF5QnRuLmNsYXNzTGlzdC50b2dnbGUoJ3ZpZGVvX19wbGF5ZXItaW1nLS1hY3RpdmUnKTtcbiAgcGxheWVyUGxheUJybi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgdmlkZW8uY3VycmVudFRpbWUgPSAwO1xufSlcbn0pO1xuXG5mdW5jdGlvbiBwbGF5U3RvcCgpIHtcbiAgcGxheWVyUGxheUJybi5jbGFzc0xpc3QudG9nZ2xlKCd2aWRlb19fcGxheWVyLWltZy0tYWN0aXZlJyk7XG4gIHBsYXlCdG4uY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XG4gIGlmICh2aWRlby5wYXVzZWQpIHtcbiAgICB2aWRlby5wbGF5KCk7XG4gICAgaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKHVwZGF0ZUR1cmF0aW9uLCAxMDAwIC8gNjApO1xuICB9IGVsc2V7XG4gICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTtcbiAgICB2aWRlby5wYXVzZSgpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHNldFZpZGVvRHVyYXRpb24oKSB7XG4gIHZpZGVvLmN1cnJlbnRUaW1lID0gZHVyYXRpb25Db250cm9sLnZhbHVlO1xuICB1cGRhdGVEdXJhdGlvbigpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVEdXJhdGlvbigpIHtcbiAgZHVyYXRpb25Db250cm9sLnZhbHVlID0gdmlkZW8uY3VycmVudFRpbWU7XG4gIGxldCBzdGVwID0gdmlkZW8uZHVyYXRpb24gLyAxMDA7XG4gIGxldCBwZXJjZW50ID0gdmlkZW8uY3VycmVudFRpbWUgLyBzdGVwO1xuICBkdXJhdGlvbkNvbnRyb2wuc3R5bGUuYmFja2dyb3VuZCA9IGBsaW5lYXItZ3JhZGllbnQoOTBkZWcsICNFMDFGM0QgMCUsICNFMDFGM0QgJHtwZXJjZW50fSUsICMzMzMgJHtwZXJjZW50fSUpYDtcbn1cblxuZnVuY3Rpb24gY2hhbmdlU291bmRWb2x1bWUoKSB7XG4gIHZpZGVvLnZvbHVtZSA9IHNvdW5kQ29udHJvbC52YWx1ZSAvIDEwO1xuICBpZih2aWRlby52b2x1bWUgPT0gMCl7XG4gICAgc291bmRCdG4uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gIH0gZWxzZSB7XG4gICAgc291bmRCdG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gc291bmRPZigpIHtcbiAgaWYgKHZpZGVvLnZvbHVtZSA9PT0gMCkge1xuICAgIHZpZGVvLnZvbHVtZSA9IHNvdW5kTGV2ZWw7XG4gICAgc291bmRDb250cm9sLnZhbHVlID0gc291bmRMZXZlbCAqIDEwO1xuICAgIHNvdW5kQnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICB9IGVsc2Uge1xuICAgIHNvdW5kTGV2ZWwgPSB2aWRlby52b2x1bWU7XG4gICAgdmlkZW8udm9sdW1lID0gMDtcbiAgICBzb3VuZENvbnRyb2wudmFsdWUgPSAwO1xuICAgIHNvdW5kQnRuLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICB9XG59IiwiY29uc3Qgc2xpZGVyID0gJCgnLnByb2R1Y3RzX19saXN0JykuYnhTbGlkZXIoe1xuICBwYWdlcjogZmFsc2UsXG4gIGNvbnRyb2xzOiBmYWxzZVxufSk7XG5cbiQoXCIucHJvZHVjdC1zbGlkZXJfX2Fycm93LS1wcmV2XCIpLmNsaWNrKGUgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIHNsaWRlci5nb1RvUHJldlNsaWRlKCk7XG5cbn0pO1xuJChcIi5wcm9kdWN0LXNsaWRlcl9fYXJyb3ctLW5leHRcIikuY2xpY2soZSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgc2xpZGVyLmdvVG9OZXh0U2xpZGUoKTtcbn0pOyIsImNvbnN0IGZpbmRCbG9ja0J5QWxpYXMgPSBhbGlhcyA9PiB7XG4gIHJldHVybiAkKFwiLnJldmlld3NfX2l0ZW1cIikuZmlsdGVyKChuZHgsIGl0ZW0pID0+IHtcbiAgICByZXR1cm4gJChpdGVtKS5hdHRyKFwiZGF0YS1saW5rZWQtd2l0aFwiKSA9PSBhbGlhcztcbiAgfSk7XG59O1xuXG4kKFwiLnJldmlldy1zd2l0Y2hlcl9fbGlua1wiKS5jbGljayhlID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1vcGVuXCIpO1xuICBjb25zdCBpdGVtdG9TaG93ID0gZmluZEJsb2NrQnlBbGlhcyh0YXJnZXQpO1xuICBjb25zdCBjdXJJdGVtID0gJHRoaXMuY2xvc2VzdChcIi5pbnRlcmFjdGl2ZS1hdmF0YXJcIik7XG5cbiAgaXRlbXRvU2hvdy5hZGRDbGFzcyhcImFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICBjdXJJdGVtLmFkZENsYXNzKFwiYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG59KTsiLCJjb25zdCBvcGVuSXRlbSA9IGl0ZW0gPT4ge1xuICBjb25zdCBjb250YWluZXIgPSBpdGVtLmNsb3Nlc3QoXCIudGVhbV9faXRlbVwiKTtcbiAgY29uc3QgY29udGVudEJsb2NrID0gY29udGFpbmVyLmZpbmQoXCIudGVhbV9fY29udGVudFwiKTtcbiAgY29uc3QgdGV4dEJsb2NrID0gY29udGVudEJsb2NrLmZpbmQoXCIudGVhbV9fY29udGVudC1ibG9ja1wiKTtcbiAgY29uc3QgcmVxSGVpZ2h0ID0gdGV4dEJsb2NrLmhlaWdodCgpO1xuXG5cbiAgY29udGFpbmVyLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICBjb250ZW50QmxvY2suaGVpZ2h0KHJlcUhlaWdodCk7XG59XG5cbmNvbnN0IGNsb3NlRXZlcnlJdGVtID0gY29udGFpbmVyID0+IHtcbiAgY29uc3QgaXRlbXMgPSBjb250YWluZXIuZmluZChcIi50ZWFtX19jb250ZW50XCIpO1xuICBjb25zdCBpdGVtQ29udGFpbmVyID0gY29udGFpbmVyLmZpbmQoXCIudGVhbV9faXRlbVwiKTtcblxuICBpdGVtQ29udGFpbmVyLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuICBpdGVtcy5oZWlnaHQoMCk7XG59XG5cbiQoXCIudGVhbV9fdGl0bGVcIikuY2xpY2soZSA9PiB7XG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnRlYW1cIik7XG4gIGNvbnN0IGVsZW1Db250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnRlYW1fX2l0ZW1cIik7XG5cbiAgaWYgKGVsZW1Db250YWluZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHtcbiAgICBjbG9zZUV2ZXJ5SXRlbShjb250YWluZXIpO1xuICB9IGVsc2Uge1xuICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XG4gICAgb3Blbkl0ZW0oJHRoaXMpO1xuICB9XG4gIFxuXG59KTsiXX0=
