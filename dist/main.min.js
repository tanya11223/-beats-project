(()=>{const a=e=>{const t=e.find(".color__item"),o=e.find(".color__content");t.removeClass("active"),o.width(0)},i=e=>{const t=e.find(".color__content");var o=(e=>{let t=0;var o=$(window).width();const n=e.closest(".colors__list"),a=n.find(".color__title");var i=a.width()*a.length;const r=e.find(".color__container");var e=parseInt(r.css("padding-left")),s=parseInt(r.css("padding-right")),c=window.matchMedia("(max-width: 768px)").matches,l=window.matchMedia("(max-width: 480px)").matches;return c&&(t=o-i),l&&(t=o-a.width()),{container:t=c||l?t:500,textContainer:t-s-e}})(e);e.addClass("active"),t.width(o.container)};$(".color__title").on("click",e=>{e.preventDefault();const t=$(e.currentTarget),o=t.closest(".color__item");var e=o.hasClass("active"),n=t.closest(".colors__list");e?a(n):(a(n),i(o))})})();const validateFields=(e,t)=>{return t.forEach(e=>{e.removeClass(".input-error"),""==e.val().trim()&&e.addClass("input-error")}),0==e.find(".input-error").length};$(".form").submit(e=>{e.preventDefault();const t=$(e.currentTarget),o=t.find("[name='name']"),n=t.find("[name='phone']"),a=t.find("[name='comment']"),i=t.find("[name= 'to']"),r=$("#modal"),s=r.find(".modal__content");if(r.removeClass("error-modal"),validateFields(t,[o,n,a,i])){const c=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:o.val(),phone:n.val(),comment:a.val(),to:i.val()}});c.done(e=>{s.text(e.message)}),c.fail(e=>{e=e.responseJSON.message;s.text(e),r.addClass("error-modal")}),c.always(()=>{$.fancybox.open({src:"#modal",type:"inline"})})}}),$(".app-close-btn").click(e=>{e.preventDefault(),$.fancybox.close()});let myMap;const init=()=>{myMap=new ymaps.Map("map",{center:[55.76,37.64],zoom:11,controls:[]});const t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/marker.svg",iconImageSize:[46,57],iconImageOffset:[-35,-52]});[[55.757349,37.622441],[55.759132,37.580903],[55.740644,37.580732],[55.742605,37.599911]].forEach(e=>{t.add(new ymaps.Placemark(e))}),myMap.geoObjects.add(t),myMap.behaviors.disable("scrollZoom")},openMenu=(ymaps.ready(init),document.querySelector("#openOverlay")),body=document.body,create=createModal();function createModal(){const t=document.createElement("div");t.classList.add("overlay");var e=document.querySelector("#overlayTemplate");t.innerHTML=e.innerHTML;const o=t.querySelector("#close");return o.addEventListener("click",e=>{e.preventDefault(),body.removeChild(t)}),t.addEventListener("click",e=>{e.preventDefault(),e.target.classList.contains("menu__link")&&body.removeChild(t)}),t}openMenu.addEventListener("click",e=>{e.preventDefault(),body.appendChild(create)});const sections=$("section"),display=$(".maincontent"),sidemenu=$(".fixed-menu"),menuItems=sidemenu.find(".fixed-menu__item"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile();let inscroll=!1;sections.first().addClass("active");const countSectionPosition=e=>{e*=-100;return isNaN(e)?(console.error("передано неверное значение в countSectionPosition"),0):e},resetActiveClassForItem=(e,t,o)=>{e.eq(t).addClass(o).siblings().removeClass(o)},performTransition=e=>{var t;inscroll||(inscroll=!0,t=countSectionPosition(e),display.css({transform:`translateY(${t}%)`}),resetActiveClassForItem(sections,e,"active"),setTimeout(()=>{inscroll=!1,resetActiveClassForItem(menuItems,e,"fixed-menu__item--active")},1300))},viewportScroller=()=>{const e=sections.filter(".active"),t=e.next(),o=e.prev();return{next(){t.length&&performTransition(t.index())},prev(){o.length&&performTransition(o.index())}}},slider=($(window).on("wheel",e=>{e=e.originalEvent.deltaY;const t=viewportScroller();0<e&&t.next(),e<0&&t.prev()}),$(window).on("keydown",e=>{var t=e.target.tagName.toLowerCase(),t="input"==t||"textarea"==t;const o=viewportScroller();if(!t)switch(e.keyCode){case 38:o.prev();break;case 40:o.next()}}),$(".wrapper").on("touchmove",e=>e.preventDefault()),$(document).on("click","[data-scroll-to]",e=>{e.preventDefault();const t=$(e.currentTarget);e=t.attr("data-scroll-to");const o=$(`[data-section-id=${e}]`);performTransition(o.index())}),isMobile&&$("body").swipe({swipe:function(e,t){const o=viewportScroller();let n="down"==t?"prev":"up"==t?"next":"";n&&o[n]()}}),$(".products__list").bxSlider({pager:!1,controls:!1})),findBlockByAlias=($(".product-slider__arrow--prev").click(e=>{e.preventDefault(),slider.goToPrevSlide()}),$(".product-slider__arrow--next").click(e=>{e.preventDefault(),slider.goToNextSlide()}),o=>$(".reviews__item").filter((e,t)=>$(t).attr("data-linked-with")==o)),openItem=($(".review-switcher__link").click(e=>{e.preventDefault();const t=$(e.currentTarget);e=t.attr("data-open");const o=findBlockByAlias(e),n=t.closest(".interactive-avatar");o.addClass("active").siblings().removeClass("active"),n.addClass("active").siblings().removeClass("active")}),e=>{const t=e.closest(".team__item"),o=t.find(".team__content"),n=o.find(".team__content-block");e=n.height();t.addClass("active"),o.height(e)}),closeEveryItem=e=>{const t=e.find(".team__content"),o=e.find(".team__item");o.removeClass("active"),t.height(0)};$(".team__title").click(e=>{const t=$(e.currentTarget);e=t.closest(".team");const o=t.closest(".team__item");o.hasClass("active")?closeEveryItem(e):(closeEveryItem(e),openItem(t))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbG9ycy1tZW51LWFjY28uanMiLCJmb3JtLW1vZGFsLmpzIiwibWFwLmpzIiwibWVudS5qcyIsIm9wcy5qcyIsInNsaWRlci5qcyIsInRhYnMuanMiLCJ0ZWFtLmpzIl0sIm5hbWVzIjpbImNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIiLCJjb250YWluZXIiLCJpdGVtcyIsImZpbmQiLCJjb250ZW50IiwicmVtb3ZlQ2xhc3MiLCJ3aWR0aCIsIm9wZW5JdGVtIiwiaXRlbSIsImhpZGRlbkNvbnRlbnQiLCJyZXFXaWR0aCIsImxldCIsInJlcUl0ZW1XaWR0aCIsInNjcmVlbldpZHRoIiwiJCIsIndpbmRvdyIsImNsb3Nlc3QiLCJ0aXRsZXNCbG9ja3MiLCJ0aXRsZXNXaWR0aCIsImxlbmd0aCIsInRleHRDb250YWluZXIiLCJwYWRkaW5nTGVmdCIsInBhcnNlSW50IiwiY3NzIiwicGFkZGluZ1JpZ2h0IiwiaXNUYWJsZXQiLCJtYXRjaE1lZGlhIiwibWF0Y2hlcyIsImlzTW9iaWxlIiwibWVzdXJlV2lkdGgiLCJhZGRDbGFzcyIsIm9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwiJHRoaXMiLCJjdXJyZW50VGFyZ2V0IiwiaXRlbU9wZW5lZCIsImhhc0NsYXNzIiwidmFsaWRhdGVGaWVsZHMiLCJmb3JtIiwiZmllbGRzQXJyYXkiLCJmb3JFYWNoIiwiZmllbGQiLCJ2YWwiLCJ0cmltIiwic3VibWl0IiwibmFtZSIsInBob25lIiwiY29tbWVudCIsInRvIiwibW9kYWwiLCJyZXF1ZXN0IiwiYWpheCIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJkb25lIiwidGV4dCIsIm1lc3NhZ2UiLCJmYWlsIiwicmVzcG9uc2VKU09OIiwiYWx3YXlzIiwiZmFuY3lib3giLCJvcGVuIiwic3JjIiwidHlwZSIsImNsaWNrIiwiY2xvc2UiLCJteU1hcCIsImluaXQiLCJ5bWFwcyIsIk1hcCIsImNlbnRlciIsInpvb20iLCJjb250cm9scyIsIm15Q29sbGVjdGlvbiIsIkdlb09iamVjdENvbGxlY3Rpb24iLCJkcmFnZ2FibGUiLCJpY29uTGF5b3V0IiwiaWNvbkltYWdlSHJlZiIsImljb25JbWFnZVNpemUiLCJpY29uSW1hZ2VPZmZzZXQiLCJjb29yZCIsImFkZCIsIlBsYWNlbWFyayIsImdlb09iamVjdHMiLCJiZWhhdmlvcnMiLCJkaXNhYmxlIiwib3Blbk1lbnUiLCJyZWFkeSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImJvZHkiLCJjcmVhdGUiLCJjcmVhdGVNb2RhbCIsIm92ZXJsYXlFbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsInRlbXBsYXRlIiwiaW5uZXJIVE1MIiwiY2xvc2VFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUNoaWxkIiwidGFyZ2V0IiwiY29udGFpbnMiLCJhcHBlbmRDaGlsZCIsInNlY3Rpb25zIiwiZGlzcGxheSIsInNpZGVtZW51IiwibWVudUl0ZW1zIiwibW9iaWxlRGV0ZWN0IiwiTW9iaWxlRGV0ZWN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwibW9iaWxlIiwiaW5zY3JvbGwiLCJmaXJzdCIsImNvdW50U2VjdGlvblBvc2l0aW9uIiwicG9zaXRpb24iLCJpc05hTiIsImNvbnNvbGUiLCJlcnJvciIsInJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtIiwiaXRlbUVxIiwiYWN0aXZlQ2xhc3MiLCJlcSIsInNpYmxpbmdzIiwicGVyZm9ybVRyYW5zaXRpb24iLCJzZWN0aW9uRXEiLCJ0cmFuc2Zvcm0iLCJzZXRUaW1lb3V0IiwidHJhbnNpdGlvbk92ZXIiLCJ2aWV3cG9ydFNjcm9sbGVyIiwiYWN0aXZlU2VjdGlvbiIsImZpbHRlciIsIm5leHRTZWN0aW9uIiwibmV4dCIsInByZXZTZWN0aW9uIiwicHJldiIsImluZGV4Iiwic2xpZGVyIiwiZGVsdGFZIiwib3JpZ2luYWxFdmVudCIsInNjcm9sbGVyIiwidGFnTmFtZSIsInRvTG93ZXJDYXNlIiwidXNlclR5cGluZ0luSW5wdXRzIiwia2V5Q29kZSIsImF0dHIiLCJyZXFTZWN0aW9uIiwic3dpcGUiLCJldmVudCIsImRpcmVjdGlvbiIsInNjcm9sbERpcmVjdGlvbiIsImJ4U2xpZGVyIiwicGFnZXIiLCJmaW5kQmxvY2tCeUFsaWFzIiwiZ29Ub1ByZXZTbGlkZSIsImdvVG9OZXh0U2xpZGUiLCJhbGlhcyIsIm5keCIsIml0ZW10b1Nob3ciLCJjdXJJdGVtIiwiY29udGVudEJsb2NrIiwidGV4dEJsb2NrIiwicmVxSGVpZ2h0IiwiaGVpZ2h0IiwiY2xvc2VFdmVyeUl0ZW0iLCJpdGVtQ29udGFpbmVyIiwiZWxlbUNvbnRhaW5lciJdLCJtYXBwaW5ncyI6IkNBQUEsS0FFQSxNQStCQUEsRUFBQUMsSUFDQSxNQUFBQyxFQUFBRCxFQUFBRSxLQUFBLGdCQUNBQyxFQUFBSCxFQUFBRSxLQUFBLG1CQUVBRCxFQUFBRyxZQUFBLFVBQ0FELEVBQUFFLE1BQUEsSUFHQUMsRUFBQUMsSUFDQSxNQUFBQyxFQUFBRCxFQUFBTCxLQUFBLG1CQUNBLElBQUFPLEdBekNBRixJQUNBRyxJQUFBQyxFQUFBLEVBQ0EsSUFBQUMsRUFBQUMsRUFBQUMsUUFBQVQsUUFDQSxNQUFBTCxFQUFBTyxFQUFBUSxRQUFBLGlCQUNBQyxFQUFBaEIsRUFBQUUsS0FBQSxpQkFDQSxJQUFBZSxFQUFBRCxFQUFBWCxRQUFBVyxFQUFBRSxPQUVBLE1BQUFDLEVBQUFaLEVBQUFMLEtBQUEscUJBQ0EsSUFBQWtCLEVBQUFDLFNBQUFGLEVBQUFHLElBQUEsaUJBQ0FDLEVBQUFGLFNBQUFGLEVBQUFHLElBQUEsa0JBR0FFLEVBQUFWLE9BQUFXLFdBQUEsc0JBQUFDLFFBQ0FDLEVBQUFiLE9BQUFXLFdBQUEsc0JBQUFDLFFBWUEsT0FWQUYsSUFDQWIsRUFBQUMsRUFBQUssR0FFQVUsSUFDQWhCLEVBQUFDLEVBQUFJLEVBQUFYLFNBTUEsQ0FDQUwsVUFKQVcsRUFEQWEsR0FBQUcsRUFLQWhCLEVBSkEsSUFLQVEsY0FBQVIsRUFBQVksRUFBQUgsSUFjQVEsQ0FBQXJCLEdBRUFBLEVBQUFzQixTQUFBLFVBQ0Fy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aEksRUFBQWxCLFFBQUEsdUJBRUFpSixFQUFBbkksU0FBQSxVQUFBZ0csV0FBQXpILFlBQUEsVUFDQTZKLEVBQUFwSSxTQUFBLFVBQUFnRyxXQUFBekgsWUFBQSxZQ2ZBRyxJQUNBLE1BQUFQLEVBQUFPLEVBQUFRLFFBQUEsZUFDQW1KLEVBQUFsSyxFQUFBRSxLQUFBLGtCQUNBaUssRUFBQUQsRUFBQWhLLEtBQUEsd0JBQ0FrSyxFQUFBRCxFQUFBRSxTQUdBckssRUFBQTZCLFNBQUEsVUFDQXFJLEVBQUFHLE9BQUFELEtBR0FFLGVBQUF0SyxJQUNBLE1BQUFDLEVBQUFELEVBQUFFLEtBQUEsa0JBQ0FxSyxFQUFBdkssRUFBQUUsS0FBQSxlQUVBcUssRUFBQW5LLFlBQUEsVUFDQUgsRUFBQW9LLE9BQUEsSUFHQXhKLEVBQUEsZ0JBQUFvRCxNQUFBbEMsSUFDQSxNQUFBRSxFQUFBcEIsRUFBQWtCLEVBQUFHLGVBQ0FsQyxFQUFBaUMsRUFBQWxCLFFBQUEsU0FDQSxNQUFBeUosRUFBQXZJLEVBQUFsQixRQUFBLGVBRUF5SixFQUFBcEksU0FBQSxVQUNBa0ksZUFBQXRLLElBRUFzSyxlQUFBdEssR0FDQU0sU0FBQTJCIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKCgpPT57XG5cbmNvbnN0IG1lc3VyZVdpZHRoID0gaXRlbSA9PiB7XG4gIGxldCByZXFJdGVtV2lkdGggPSAwO1xuICBjb25zdCBzY3JlZW5XaWR0aCA9ICQod2luZG93KS53aWR0aCgpO1xuICBjb25zdCBjb250YWluZXIgPSBpdGVtLmNsb3Nlc3QoXCIuY29sb3JzX19saXN0XCIpO1xuICBjb25zdCB0aXRsZXNCbG9ja3MgPSBjb250YWluZXIuZmluZChcIi5jb2xvcl9fdGl0bGVcIik7XG4gIGNvbnN0IHRpdGxlc1dpZHRoID0gdGl0bGVzQmxvY2tzLndpZHRoKCkgKiB0aXRsZXNCbG9ja3MubGVuZ3RoO1xuXG4gIGNvbnN0IHRleHRDb250YWluZXIgPSBpdGVtLmZpbmQoXCIuY29sb3JfX2NvbnRhaW5lclwiKTtcbiAgY29uc3QgcGFkZGluZ0xlZnQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctbGVmdFwiKSk7XG4gIGNvbnN0IHBhZGRpbmdSaWdodCA9IHBhcnNlSW50KHRleHRDb250YWluZXIuY3NzKFwicGFkZGluZy1yaWdodFwiKSk7XG5cblxuICBjb25zdCBpc1RhYmxldCA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNzY4cHgpXCIpLm1hdGNoZXM7XG4gIGNvbnN0IGlzTW9iaWxlID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWF4LXdpZHRoOiA0ODBweClcIikubWF0Y2hlcztcblxuICBpZihpc1RhYmxldCkge1xuICAgIHJlcUl0ZW1XaWR0aCA9IHNjcmVlbldpZHRoIC0gdGl0bGVzV2lkdGg7XG4gIH0gXG4gIGlmKGlzTW9iaWxlKSB7XG4gICAgcmVxSXRlbVdpZHRoID0gc2NyZWVuV2lkdGggLSB0aXRsZXNCbG9ja3Mud2lkdGgoKTtcbiAgfSBcbiAgaWYoIWlzVGFibGV0ICYmICFpc01vYmlsZSl7XG4gICAgcmVxSXRlbVdpZHRoID0gNTAwO1xuICB9XG5cbiAgcmV0dXJue1xuICAgIGNvbnRhaW5lcjogcmVxSXRlbVdpZHRoLFxuICAgIHRleHRDb250YWluZXI6IHJlcUl0ZW1XaWR0aCAtIHBhZGRpbmdSaWdodCAtIHBhZGRpbmdMZWZ0XG4gIH1cbn07XG5cbmNvbnN0IGNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIgPSBjb250YWluZXIgPT4ge1xuICBjb25zdCBpdGVtcyA9IGNvbnRhaW5lci5maW5kKFwiLmNvbG9yX19pdGVtXCIpO1xuICBjb25zdCBjb250ZW50ID0gY29udGFpbmVyLmZpbmQoXCIuY29sb3JfX2NvbnRlbnRcIik7XG5cbiAgaXRlbXMucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gIGNvbnRlbnQud2lkdGgoMCk7XG59O1xuXG5jb25zdCBvcGVuSXRlbSA9IGl0ZW0gPT4ge1xuICBjb25zdCBoaWRkZW5Db250ZW50ID0gaXRlbS5maW5kKFwiLmNvbG9yX19jb250ZW50XCIpO1xuICBjb25zdCByZXFXaWR0aCA9IG1lc3VyZVdpZHRoKGl0ZW0pO1xuXG4gIGl0ZW0uYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4gIGhpZGRlbkNvbnRlbnQud2lkdGgocmVxV2lkdGguY29udGFpbmVyKTtcbn1cblxuJChcIi5jb2xvcl9fdGl0bGVcIikub24oXCJjbGlja1wiLCAoZSkgPT57XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgXG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICBjb25zdCBpdGVtID0gJHRoaXMuY2xvc2VzdChcIi5jb2xvcl9faXRlbVwiKTtcbiAgY29uc3QgaXRlbU9wZW5lZCA9IGl0ZW0uaGFzQ2xhc3MoXCJhY3RpdmVcIik7XG4gIGNvbnN0IGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIuY29sb3JzX19saXN0XCIpO1xuXG4gIGlmIChpdGVtT3BlbmVkKSB7XG4gICAgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lcihjb250YWluZXIpXG4gIH0gZWxzZSB7XG4gICAgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lcihjb250YWluZXIpXG4gICAgb3Blbkl0ZW0oaXRlbSk7XG4gIH1cbn0pO1xufSkoKTsiLCJjb25zdCB2YWxpZGF0ZUZpZWxkcyA9IChmb3JtLCBmaWVsZHNBcnJheSkgPT4ge1xuICBmaWVsZHNBcnJheS5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICBmaWVsZC5yZW1vdmVDbGFzcyhcIi5pbnB1dC1lcnJvclwiKTtcbiAgICBpZiAoZmllbGQudmFsKCkudHJpbSgpID09IFwiXCIpIHtcbiAgICAgIGZpZWxkLmFkZENsYXNzKFwiaW5wdXQtZXJyb3JcIik7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBlcnJvckZpZWxkcyA9IGZvcm0uZmluZChcIi5pbnB1dC1lcnJvclwiKTtcblxuICByZXR1cm4gZXJyb3JGaWVsZHMubGVuZ3RoID09IDA7XG59XG5cbiQoXCIuZm9ybVwiKS5zdWJtaXQoZSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBmb3JtID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICBjb25zdCBuYW1lID0gZm9ybS5maW5kKFwiW25hbWU9J25hbWUnXVwiKTtcbiAgY29uc3QgcGhvbmUgPSBmb3JtLmZpbmQoXCJbbmFtZT0ncGhvbmUnXVwiKTtcbiAgY29uc3QgY29tbWVudCA9IGZvcm0uZmluZChcIltuYW1lPSdjb21tZW50J11cIik7XG4gIGNvbnN0IHRvID0gZm9ybS5maW5kKFwiW25hbWU9ICd0byddXCIpO1xuXG4gIGNvbnN0IG1vZGFsID0gJChcIiNtb2RhbFwiKTtcbiAgY29uc3QgY29udGVudCA9IG1vZGFsLmZpbmQoXCIubW9kYWxfX2NvbnRlbnRcIik7XG4gIFxuICBtb2RhbC5yZW1vdmVDbGFzcyhcImVycm9yLW1vZGFsXCIpO1xuXG4gIGNvbnN0IGlzVmFsaWQgPSB2YWxpZGF0ZUZpZWxkcyhmb3JtLCBbbmFtZSwgcGhvbmUsIGNvbW1lbnQsIHRvXSk7XG4gIFxuICBcbiAgXG5cbiAgaWYgKGlzVmFsaWQpIHtcbiAgICBjb25zdCByZXF1ZXN0ID0gJC5hamF4KHtcbiAgICAgIHVybDogXCJodHRwczovL3dlYmRldi1hcGkubG9mdHNjaG9vbC5jb20vc2VuZG1haWxcIixcbiAgICAgIG1ldGhvZDogXCJwb3N0XCIsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIG5hbWU6IG5hbWUudmFsKCksXG4gICAgICAgIHBob25lOiBwaG9uZS52YWwoKSxcbiAgICAgICAgY29tbWVudDogY29tbWVudC52YWwoKSxcbiAgICAgICAgdG86IHRvLnZhbCgpLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIHJlcXVlc3QuZG9uZShkYXRhID0+e1xuICAgICAgY29udGVudC50ZXh0KGRhdGEubWVzc2FnZSk7XG4gICAgfSk7XG5cbiAgICByZXF1ZXN0LmZhaWwoZGF0YSA9PntcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBkYXRhLnJlc3BvbnNlSlNPTi5tZXNzYWdlO1xuICAgICAgY29udGVudC50ZXh0KG1lc3NhZ2UpO1xuICAgICAgbW9kYWwuYWRkQ2xhc3MoXCJlcnJvci1tb2RhbFwiKTtcbiAgICB9KTtcblxuICAgIHJlcXVlc3QuYWx3YXlzKCgpID0+IHtcbiAgICAgICQuZmFuY3lib3gub3Blbih7XG4gICAgICAgIHNyYzogXCIjbW9kYWxcIixcbiAgICAgICAgdHlwZTogXCJpbmxpbmVcIlxuICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59KTtcblxuJChcIi5hcHAtY2xvc2UtYnRuXCIpLmNsaWNrKGUgPT57XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICAkLmZhbmN5Ym94LmNsb3NlKCk7XG59KTsiLCJsZXQgbXlNYXA7XG5cbmNvbnN0IGluaXQgPSAoKSA9PiB7XG4gIG15TWFwID0gbmV3IHltYXBzLk1hcChcIm1hcFwiLCB7XG4gICAgY2VudGVyOiBbNTUuNzYsIDM3LjY0XSxcbiAgICB6b29tOiAxMSxcbiAgICBjb250cm9sczogW10sXG4gIH0pO1xuXG4gIGNvbnN0IGNvb3JkcyA9IFtcbiAgICBbNTUuNzU3MzQ5LCAzNy42MjI0NDFdLFxuICAgIFs1NS43NTkxMzIsIDM3LjU4MDkwM10sXG4gICAgWzU1Ljc0MDY0NCwgMzcuNTgwNzMyXSxcbiAgICBbNTUuNzQyNjA1LCAzNy41OTk5MTFdLFxuICBdO1xuXG4gIGNvbnN0IG15Q29sbGVjdGlvbiA9IG5ldyB5bWFwcy5HZW9PYmplY3RDb2xsZWN0aW9uKHt9LHtcbiAgICAgZHJhZ2dhYmxlOiBmYWxzZSxcbiAgICAgaWNvbkxheW91dDogJ2RlZmF1bHQjaW1hZ2UnLFxuICAgICBpY29uSW1hZ2VIcmVmOiBcIi4vaW1nL21hcmtlci5zdmdcIixcbiAgICAgaWNvbkltYWdlU2l6ZTogWzQ2LCA1N10sXG4gICAgIGljb25JbWFnZU9mZnNldDogWy0zNSwgLTUyXVxuICB9KTtcblxuICBjb29yZHMuZm9yRWFjaChjb29yZCA9PiB7XG4gICAgbXlDb2xsZWN0aW9uLmFkZChuZXcgeW1hcHMuUGxhY2VtYXJrKGNvb3JkKSk7XG4gIH0pO1xuXG4gIG15TWFwLmdlb09iamVjdHMuYWRkKG15Q29sbGVjdGlvbik7XG5cbiAgbXlNYXAuYmVoYXZpb3JzLmRpc2FibGUoJ3Njcm9sbFpvb20nKTtcbn1cblxueW1hcHMucmVhZHkoaW5pdCk7IiwiY29uc3Qgb3Blbk1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI29wZW5PdmVybGF5XCIpO1xuY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHk7XG5jb25zdCBjcmVhdGUgPSBjcmVhdGVNb2RhbCgpO1xuXG5vcGVuTWVudS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgYm9keS5hcHBlbmRDaGlsZChjcmVhdGUpO1xufSlcblxuZnVuY3Rpb24gY3JlYXRlTW9kYWwgKCkge1xuICBjb25zdCBvdmVybGF5RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJvdmVybGF5XCIpOyBcblxuICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjb3ZlcmxheVRlbXBsYXRlXCIpO1xuXG4gIG92ZXJsYXlFbGVtZW50LmlubmVySFRNTCA9IHRlbXBsYXRlLmlubmVySFRNTDsgXG5cbiAgY29uc3QgY2xvc2VFbGVtZW50ID0gb3ZlcmxheUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNjbG9zZVwiKTtcblxuICBjbG9zZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGUgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXlFbGVtZW50KTtcbiAgfSk7XG5cbiAgb3ZlcmxheUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGlmKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbWVudV9fbGluaycpKSB7XG4gICAgICBib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXlFbGVtZW50KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBvdmVybGF5RWxlbWVudDtcbn0iLCJjb25zdCBzZWN0aW9ucyA9ICQoXCJzZWN0aW9uXCIpO1xuY29uc3QgZGlzcGxheSA9ICQoXCIubWFpbmNvbnRlbnRcIik7XG5jb25zdCBzaWRlbWVudSA9ICQoXCIuZml4ZWQtbWVudVwiKTtcbmNvbnN0IG1lbnVJdGVtcyA9IHNpZGVtZW51LmZpbmQoXCIuZml4ZWQtbWVudV9faXRlbVwiKTtcblxuY29uc3QgbW9iaWxlRGV0ZWN0ID0gbmV3IE1vYmlsZURldGVjdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7XG5jb25zdCBpc01vYmlsZSA9IG1vYmlsZURldGVjdC5tb2JpbGUoKTtcblxubGV0IGluc2Nyb2xsID0gZmFsc2U7XG5cbnNlY3Rpb25zLmZpcnN0KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG5cbmNvbnN0IGNvdW50U2VjdGlvblBvc2l0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xuICBjb25zdCBwb3NpdGlvbiA9IHNlY3Rpb25FcSAqIC0xMDA7XG5cbiAgaWYgKGlzTmFOKHBvc2l0aW9uKSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCLQv9C10YDQtdC00LDQvdC+INC90LXQstC10YDQvdC+0LUg0LfQvdCw0YfQtdC90LjQtSDQsiBjb3VudFNlY3Rpb25Qb3NpdGlvblwiKTtcbiAgICByZXR1cm4gMDtcbiAgfVxuICByZXR1cm4gcG9zaXRpb247XG59XG5cbmNvbnN0IHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtID0gKGl0ZW1zLCBpdGVtRXEsIGFjdGl2ZUNsYXNzKSA9PiB7XG4gIGl0ZW1zLmVxKGl0ZW1FcSkuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xufVxuXG5jb25zdCBwZXJmb3JtVHJhbnNpdGlvbiA9IChzZWN0aW9uRXEpID0+IHtcblxuICBpZihpbnNjcm9sbCkgcmV0dXJuO1xuXG4gICAgY29uc3QgdHJhbnNpdGlvbk92ZXIgPSAxMDAwO1xuICAgIGNvbnN0IG1vdXNlSW5lcnRpYU92ZXIgPSAzMDA7XG5cbiAgICBpbnNjcm9sbCA9IHRydWU7XG4gICAgY29uc3QgcG9zaXRpb24gPSBjb3VudFNlY3Rpb25Qb3NpdGlvbihzZWN0aW9uRXEpO1xuXG4gIGRpc3BsYXkuY3NzKHtcbiAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7cG9zaXRpb259JSlgXG4gIH0pO1xuICBcbiAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0oc2VjdGlvbnMsIHNlY3Rpb25FcSwgXCJhY3RpdmVcIik7XG5cbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgIGluc2Nyb2xsID0gZmFsc2U7XG5cbiAgICAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0obWVudUl0ZW1zLCBzZWN0aW9uRXEsIFwiZml4ZWQtbWVudV9faXRlbS0tYWN0aXZlXCIpO1xuXG5cbiAgfSwgdHJhbnNpdGlvbk92ZXIgKyBtb3VzZUluZXJ0aWFPdmVyKTtcbiAgfVxuXG5jb25zdCB2aWV3cG9ydFNjcm9sbGVyID0gKCkgPT4ge1xuICBjb25zdCBhY3RpdmVTZWN0aW9uID0gc2VjdGlvbnMuZmlsdGVyKFwiLmFjdGl2ZVwiKTtcbiAgY29uc3QgbmV4dFNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLm5leHQoKTtcbiAgY29uc3QgcHJldlNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLnByZXYoKTtcbiAgXG4gIHJldHVybntcbiAgICBuZXh0KCkge1xuICAgICAgaWYobmV4dFNlY3Rpb24ubGVuZ3RoKSB7XG4gICAgICAgIHBlcmZvcm1UcmFuc2l0aW9uKG5leHRTZWN0aW9uLmluZGV4KCkpXG4gICAgICB9XG4gICAgfSxcbiAgICBwcmV2KCkgeyAgXG4gICAgaWYocHJldlNlY3Rpb24ubGVuZ3RoKSB7XG4gICAgcGVyZm9ybVRyYW5zaXRpb24ocHJldlNlY3Rpb24uaW5kZXgoKSlcbiAgfVxuICB9LFxuICB9O1xufTtcblxuJCh3aW5kb3cpLm9uKFwid2hlZWxcIiwgZSA9PiB7XG4gIGNvbnN0IGRlbHRhWSA9IGUub3JpZ2luYWxFdmVudC5kZWx0YVk7XG4gIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xuICBcbiAgaWYgKGRlbHRhWSA+IDApICB7XG4gICAgc2Nyb2xsZXIubmV4dCgpO1xuICB9XG5cbiAgaWYgKGRlbHRhWSA8IDApIHtcbiAgICBzY3JvbGxlci5wcmV2KCk7XG4gIH1cbn0pO1xuXG4kKHdpbmRvdykub24oXCJrZXlkb3duXCIsIGUgPT4ge1xuICBjb25zdCB0YWdOYW1lID0gZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCB1c2VyVHlwaW5nSW5JbnB1dHMgPSB0YWdOYW1lID09IFwiaW5wdXRcIiB8fCB0YWdOYW1lID09IFwidGV4dGFyZWFcIjtcbiAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XG5cbiAgaWYgKHVzZXJUeXBpbmdJbklucHV0cykgcmV0dXJuO1xuICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XG4gICAgICBjYXNlIDM4OiAvL3ByZXZcbiAgICAgICBzY3JvbGxlci5wcmV2KCk7XG4gICAgICAgYnJlYWs7XG4gIFxuICAgICAgY2FzZSA0MDogLy9uZXh0XG4gICAgICAgc2Nyb2xsZXIubmV4dCgpO1xuICAgICAgIGJyZWFrO1xuICAgIH1cbiAgXG59KTtcblxuJChcIi53cmFwcGVyXCIpLm9uKFwidG91Y2htb3ZlXCIsZSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xuXG4kKGRvY3VtZW50KS5vbihcImNsaWNrXCIsIFwiW2RhdGEtc2Nyb2xsLXRvXVwiLCBlID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1zY3JvbGwtdG9cIik7XG4gIGNvbnN0IHJlcVNlY3Rpb24gPSAkKGBbZGF0YS1zZWN0aW9uLWlkPSR7dGFyZ2V0fV1gKTtcblxuICBwZXJmb3JtVHJhbnNpdGlvbihyZXFTZWN0aW9uLmluZGV4KCkpO1xufSk7XG5cbi8vdG91Y2ggc3dpcGUgXG5pZiAoaXNNb2JpbGUpIHtcbiAgLy9odHRwczovL2dpdGh1Yi5jb20vbWF0dGJyeXNvbi9Ub3VjaFN3aXBlLUpxdWVyeS1QbHVnaW5cbiQoXCJib2R5XCIpLnN3aXBlKCB7XG4gIHN3aXBlOmZ1bmN0aW9uKFxuICAgIGV2ZW50LCBcbiAgICBkaXJlY3Rpb24sXG4gICAgICkge1xuICAgIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xuICAgIGxldCBzY3JvbGxEaXJlY3Rpb24gPSBcIlwiO1xuXG4gICAgaWYgKGRpcmVjdGlvbiA9PSBcInVwXCIpIHNjcm9sbERpcmVjdGlvbiA9IFwibmV4dFwiO1xuICAgIGlmIChkaXJlY3Rpb24gPT0gXCJkb3duXCIpIHNjcm9sbERpcmVjdGlvbiA9IFwicHJldlwiO1xuICAgIGlmICghc2Nyb2xsRGlyZWN0aW9uKSByZXR1cm47XG4gICAgXG4gICAgc2Nyb2xsZXJbc2Nyb2xsRGlyZWN0aW9uXSgpO1xuICB9LFxufSk7XG59XG4iLCJjb25zdCBzbGlkZXIgPSAkKCcucHJvZHVjdHNfX2xpc3QnKS5ieFNsaWRlcih7XG4gIHBhZ2VyOiBmYWxzZSxcbiAgY29udHJvbHM6IGZhbHNlXG59KTtcblxuJChcIi5wcm9kdWN0LXNsaWRlcl9fYXJyb3ctLXByZXZcIikuY2xpY2soZSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgc2xpZGVyLmdvVG9QcmV2U2xpZGUoKTtcblxufSk7XG4kKFwiLnByb2R1Y3Qtc2xpZGVyX19hcnJvdy0tbmV4dFwiKS5jbGljayhlID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBzbGlkZXIuZ29Ub05leHRTbGlkZSgpO1xufSk7IiwiY29uc3QgZmluZEJsb2NrQnlBbGlhcyA9IGFsaWFzID0+IHtcbiAgcmV0dXJuICQoXCIucmV2aWV3c19faXRlbVwiKS5maWx0ZXIoKG5keCwgaXRlbSkgPT4ge1xuICAgIHJldHVybiAkKGl0ZW0pLmF0dHIoXCJkYXRhLWxpbmtlZC13aXRoXCIpID09IGFsaWFzO1xuICB9KTtcbn07XG5cbiQoXCIucmV2aWV3LXN3aXRjaGVyX19saW5rXCIpLmNsaWNrKGUgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XG4gIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLW9wZW5cIik7XG4gIGNvbnN0IGl0ZW10b1Nob3cgPSBmaW5kQmxvY2tCeUFsaWFzKHRhcmdldCk7XG4gIGNvbnN0IGN1ckl0ZW0gPSAkdGhpcy5jbG9zZXN0KFwiLmludGVyYWN0aXZlLWF2YXRhclwiKTtcblxuICBpdGVtdG9TaG93LmFkZENsYXNzKFwiYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gIGN1ckl0ZW0uYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbn0pOyIsImNvbnN0IG9wZW5JdGVtID0gaXRlbSA9PiB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGl0ZW0uY2xvc2VzdChcIi50ZWFtX19pdGVtXCIpO1xuICBjb25zdCBjb250ZW50QmxvY2sgPSBjb250YWluZXIuZmluZChcIi50ZWFtX19jb250ZW50XCIpO1xuICBjb25zdCB0ZXh0QmxvY2sgPSBjb250ZW50QmxvY2suZmluZChcIi50ZWFtX19jb250ZW50LWJsb2NrXCIpO1xuICBjb25zdCByZXFIZWlnaHQgPSB0ZXh0QmxvY2suaGVpZ2h0KCk7XG5cblxuICBjb250YWluZXIuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4gIGNvbnRlbnRCbG9jay5oZWlnaHQocmVxSGVpZ2h0KTtcbn1cblxuY29uc3QgY2xvc2VFdmVyeUl0ZW0gPSBjb250YWluZXIgPT4ge1xuICBjb25zdCBpdGVtcyA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2NvbnRlbnRcIik7XG4gIGNvbnN0IGl0ZW1Db250YWluZXIgPSBjb250YWluZXIuZmluZChcIi50ZWFtX19pdGVtXCIpO1xuXG4gIGl0ZW1Db250YWluZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gIGl0ZW1zLmhlaWdodCgwKTtcbn1cblxuJChcIi50ZWFtX190aXRsZVwiKS5jbGljayhlID0+IHtcbiAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XG4gIGNvbnN0IGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIudGVhbVwiKTtcbiAgY29uc3QgZWxlbUNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIudGVhbV9faXRlbVwiKTtcblxuICBpZiAoZWxlbUNvbnRhaW5lci5oYXNDbGFzcyhcImFjdGl2ZVwiKSkge1xuICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XG4gIH0gZWxzZSB7XG4gICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTtcbiAgICBvcGVuSXRlbSgkdGhpcyk7XG4gIH1cbiAgXG5cbn0pOyJdfQ==
